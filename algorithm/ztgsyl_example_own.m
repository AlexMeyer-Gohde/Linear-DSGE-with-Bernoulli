%% Building infos:
% Linux and gfortran (Debug)
% mex -R2018a -g -v FFLAGS='$FFLAGS -Wall -Wextra -Warray-temporaries -Wconversion -fimplicit-none -fcheck=all -fbacktrace -ffree-line-length-0 -ffpe-trap=invalid,zero,overflow,underflow -finit-real=nan' ztgsyl.F
% Windows and ifort (Intel OneAPI Base + HPC and Visual Studio) (Debug)
% mex -R2018a -lmwlapack -g -v COMPFLAGS='$COMPFLAGS /Debug /traceback' ztgsyl.F

format short;
num_simulations = 100000;
%% Run example

A = [4 + 4i, 1 + 1i, 1 + 1i, 2 - 1i; ...
      0 + 0i, 2 + 1i, 1 + 1i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 2 - 1i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 0 + 0i, 6 - 2i];
B = [2 + 0i, 1 + 1i, 1 + 1i, 3 - 1i; ...
      0 + 0i, 1 + 0i, 2 + 1i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 1 + 0i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 0 + 0i, 2 + 0i];
D = [1 + 1i, 1 - 1i, 1 + 1i, 1 - 1i; ...
      0 + 0i, 6 - 4i, 1 - 1i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 2 + 4i, 1 - 1i; ...
      0 + 0i, 0 + 0i, 0 + 0i, 2 + 3i]; 
E = [1 + 0i, 1 + 1i, 1 - 1i, 1 + 1i; ...
      0 + 0i, 2 + 0i, 1 + 1i, 1 - 1i; ...
      0 + 0i, 0 + 0i, 2 + 0i, 1 + 1i; ...
      0 + 0i, 0 + 0i, 0 + 0i, 1 + 0i];
C = [-13 + 9i, 2 + 8i, -2 + 8i, -2 + 5i; ...
      -9 - 1i, 0 + 5i, -7 - 3i, -6 + 0i; ...
      -1 + 1i, 4 + 2i, 4 - 5i, 9 - 5i; ...
      -6 + 6i, 9 + 1i, -2 + 4i, 22 - 8i];
F = [-6 + 5i, 4 - 4i, -3 + 11i, 3 - 7i; ...
      -5 + 11i, 12 - 4i, -2 + 2i, 0 + 14i; ...
      -5 - 1i, 0 + 4i, -2 + 10i, 3 - 1i; ...
      -6 - 2i, 1 + 1i, -7 - 3i, 4 + 7i];

ijob = 0;

tic;
for i = 1:num_simulations
    [R L dif scale work iwork] = ztgsyl('N',ijob,A,B,C,D,E,F);
end
timeuse = toc;
fprintf('\nTime elapsed: %3.2f\n\n', timeuse);

disp('Solution R:');
disp(R);
disp('Solution L:');
disp(L);
disp('Scale:');
disp(scale);